<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userMapper">
	<resultMap type="userDTO" id="selectUserMap">
		<id column="id" property="id"/>
		<result column="password" property="password"/>
		<result column="name" property="name"/>
		<result column="age" property="age"/>
		<result column="gender" property="gender"/>
		<result column="register_date" property="registerDate"/>
		<result column="update_date" property="updateDate"/>
		<result column="file_name" property="fileName"/>
		<result column="state" property="state"/>
	</resultMap>
	
	<select id="selectUserById" parameterType="String" resultMap="selectUserMap">
		select id,name,file_name from user_table where id = #{id} and password=#{password}
	</select>
	
	<select id="checkUserById" parameterType="String" resultType="String">
		select name from user_table where id = #{value}
	</select>
	
	<insert id="insertUser" parameterType="userDTO">
		insert into 
		user_table(id,password,name,age,gender,register_date,file_name,state)
		values(#{id},#{password},#{name},#{age},#{gender},sysdate,#{fileName,jdbcType=VARCHAR},0)
	</insert>
	
	<select id="selectUser" parameterType="String" resultMap="selectUserMap">
		select id,name,file_name from user_table where id=#{value} and state='0'
	</select>
	
	<select id="selectProfile" parameterType="String" resultMap="selectUserMap">
		select id,name,age,gender,file_name from user_table where id=#{value}
	</select>
	
	<select id="searchUser" parameterType="String" resultMap="selectUserMap">
		select id,name,age,gender,file_name from user_table where (name like '%${value}%')
	</select>
	
	<update id="updateUser" parameterType="userDTO">
		update user_table
		<trim prefix="set" suffixOverrides=",">
			<if test="name!=null">
				name=#{name},
			</if>
			<if test="age!=null">
				age=#{age},
			</if>
			<if test="gender!=null">
				gender=#{gender},
			</if>
			<if test="fileName!=null">
				file_name=#{fileName},
			</if>
			update_date=#{updateDate}
		</trim>
		where id=#{id}
	</update>
</mapper>